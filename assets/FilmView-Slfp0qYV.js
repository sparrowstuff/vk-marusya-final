import{d as w,a as R,u as N,b as Z,r as m,o as $,v as A,c as n,e as r,f as e,n as p,t as o,F as U,y as E,h as a,_ as g,l as V}from"./index-C6prHhVu.js";import{u as W}from"./basketStore-DN1xKs_o.js";const Y={key:0,class:"detailed-movie"},z={class:"detailed-movie__wrapper"},H={class:"detailed-movie__info-block"},j={class:"detailed-movie__details"},q={class:"detailed-movie__rating-text"},G={class:"detailed-movie__release-year"},J={class:"detailed-movie__genre"},K={class:"detailed-movie__duration"},O={class:"detailed-movie__title"},P={class:"detailed-movie__description"},Q={class:"detailed-movie__actions"},X={key:0,class:"detailed-movie__like-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ee={key:1,class:"detailed-movie__like-icon-filled",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},te=["alt","src"],ie=["src","alt"],se={key:1,class:"loader"},oe={class:"movie-description"},ae={class:"movie-description__description-block"},le={class:"movie-description__info-block"},ne={class:"movie-description__info"},re={class:"movie-description__info-block"},de={class:"movie-description__info"},ce={class:"movie-description__info-block"},_e={class:"movie-description__info"},ve={class:"movie-description__info-block"},ue={class:"movie-description__info"},me={class:"movie-description__info-block"},pe={class:"movie-description__info"},fe={class:"movie-description__info-block"},he={class:"movie-description__info"},we=w({inheritAttrs:!1,__name:"DetailedMovie",emits:["open-auth-modal"],setup(b,{emit:C}){const d=E(),k=R(),y=N(),c=W(),L=Z(),_=m(!0),l=m(!1),i=m(null),f=async()=>{const s=d.params.id;if(!s){console.error("Film ID is missing"),_.value=!1;return}_.value=!0,i.value=null;try{const t=parseInt(s);if(isNaN(t))throw new Error(`Invalid film ID: ${s}`);const u=await k.getMovieById(t);i.value=u}catch(t){console.error("Ошибка загрузки фильма:",t)}finally{_.value=!1}};$(async()=>{await f()}),A(()=>d.params.id,async()=>{await f()});const B=s=>{let t=Math.trunc(s/60),u=s%60;return`${t} ч. ${u} мин`},x=n(()=>{if(!i.value.tmdbRating)return"";const s=i.value.tmdbRating;if(s>=8.6)return"detailed-movie__rating--gold";if(s>=7.5)return"detailed-movie__rating--green";if(s>=6.3)return"detailed-movie__rating--grey";if(s>=4.2)return"detailed-movie__rating--red"}),v=n(()=>!i.value.id||!i.value?!1:c.isInBasket(i.value.id)),I=()=>{l.value=!l.value},M=()=>{i.value&&(y.isAuthenticated?v.value?c.removeFromBasket(i.value.id):c.addToBasket(i.value):L.openModalWindow())},F=n(()=>{if(!i.value?.trailerUrl)return"";const s=i.value.trailerUrl;let t="";return s.includes("youtube.com/watch?v=")?t=s.split("v=")[1]?.split("&")[0]:s.includes("youtu.be/")?t=s.split("youtu.be/")[1]?.split("?")[0]:i.value.trailerYouTubeId&&(t=i.value.trailerYouTubeId),t?`https://www.youtube.com/embed/${t}?autoplay=1`:""}),S=()=>{l.value=!l.value},h=s=>s?s.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" руб":"Неизвестно",T=n(()=>h(i.value?.budget)),D=n(()=>h(i.value?.revenue));return(s,t)=>(a(),r(U,null,[i.value?(a(),r("article",Y,[e("div",z,[e("div",H,[e("div",j,[e("span",{class:p(["detailed-movie__rating",x.value])},[t[0]||(t[0]=e("svg",{class:"detailed-movie__star",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M8.00105 12.1734L3.29875 14.8055L4.34897 9.51997L0.392578 5.86124L5.74394 5.22675L8.00105 0.333374L10.2581 5.22675L15.6095 5.86124L11.6531 9.51997L12.7033 14.8055L8.00105 12.1734Z",fill:"white"})],-1)),e("span",q,o(i.value.tmdbRating),1)],2),e("span",G,o(i.value.releaseYear),1),e("span",J,o(i.value.genres?.[0]),1),e("span",K,o(B(i.value.runtime)),1)]),e("h2",O,o(i.value.title),1),e("p",P,o(i.value.plot),1),e("div",Q,[e("button",{class:"detailed-movie__trailer-btn btn",type:"button",onClick:I}," Трейлер"),e("button",{class:p(["detailed-movie__favorite-btn btn btn--circle",{"detailed-movie__favorite-btn--clicked":v.value}]),type:"button",onClick:M},[v.value?(a(),r("svg",ee,[...t[2]||(t[2]=[e("path",{d:"M16.5 3C19.5376 3 22 5.5 22 9C22 16 14.5 20 12 21.5C9.5 20 2 16 2 9C2 5.5 4.5 3 7.5 3C9.35997 3 11 4 12 5C13 4 14.64 3 16.5 3Z",fill:"#B4A9FF"},null,-1)])])):(a(),r("svg",X,[...t[1]||(t[1]=[e("path",{d:"M16.5 3C19.5376 3 22 5.5 22 9C22 16 14.5 20 12 21.5C9.5 20 2 16 2 9C2 5.5 4.5 3 7.5 3C9.35997 3 11 4 12 5C13 4 14.64 3 16.5 3ZM12.9339 18.6038C13.8155 18.0485 14.61 17.4955 15.3549 16.9029C18.3337 14.533 20 11.9435 20 9C20 6.64076 18.463 5 16.5 5C15.4241 5 14.2593 5.56911 13.4142 6.41421L12 7.82843L10.5858 6.41421C9.74068 5.56911 8.5759 5 7.5 5C5.55906 5 4 6.6565 4 9C4 11.9435 5.66627 14.533 8.64514 16.9029C9.39 17.4955 10.1845 18.0485 11.0661 18.6038C11.3646 18.7919 11.6611 18.9729 12 19.1752C12.3389 18.9729 12.6354 18.7919 12.9339 18.6038Z",fill:"currentColor"},null,-1)])]))],2)])]),e("img",{class:"detailed-movie__img",alt:i.value.title,src:i.value.posterUrl,width:"680",height:"300",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:"",title:"Трейлер фильма"},null,8,te)]),e("div",{class:p(["detailed-movie__watch-trailer-window",{"detailed-movie__watch-trailer-window--show":l.value}])},[e("button",{class:"detailed-movie__close-trailer-btn btn btn--close",type:"button",onClick:S},[...t[3]||(t[3]=[e("svg",{class:"detailed-movie__close-btn-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.5859 12L2.79297 4.20706L4.20718 2.79285L12.0001 10.5857L19.793 2.79285L21.2072 4.20706L13.4143 12L21.2072 19.7928L19.793 21.2071L12.0001 13.4142L4.20718 21.2071L2.79297 19.7928L10.5859 12Z",fill:"black"})],-1)])]),e("iframe",{src:F.value,alt:i.value.title,class:"detailed-movie__iframe",controls:"",width:"960",height:"540"},null,8,ie)],2)])):(a(),r("span",se)),e("article",oe,[t[10]||(t[10]=e("h3",{class:"movie-description__title"},"О фильме",-1)),e("div",ae,[e("div",le,[t[4]||(t[4]=e("span",{class:"movie-description__info-name"},"Язык оригинала",-1)),e("span",ne,o(i.value?.language||"Неизвестно"),1)]),e("div",re,[t[5]||(t[5]=e("span",{class:"movie-description__info-name"},"Бюджет",-1)),e("span",de,o(T.value||"Неизвестно"),1)]),e("div",ce,[t[6]||(t[6]=e("span",{class:"movie-description__info-name"},"Выручка",-1)),e("span",_e,o(D.value||"Неизвестно"),1)]),e("div",ve,[t[7]||(t[7]=e("span",{class:"movie-description__info-name"},"Режиссёр",-1)),e("span",ue,o(i.value?.director||"Неизвестно"),1)]),e("div",me,[t[8]||(t[8]=e("span",{class:"movie-description__info-name"},"Продакшен",-1)),e("span",pe,o(i.value?.production||"Неизвестно"),1)]),e("div",fe,[t[9]||(t[9]=e("span",{class:"movie-description__info-name"},"Награды",-1)),e("span",he,o(i.value?.awardsSummary||"Неизвестно"),1)])])])],64))}}),ge=g(we,[["__scopeId","data-v-1b2cd312"]]),be=w({__name:"FilmView",setup(b){return(C,d)=>(a(),V(ge))}}),ye=g(be,[["__scopeId","data-v-fd58d9d5"]]);export{ye as default};
