import{d as J,u as oe,a as $,r as x,b as ne,o as K,c as O,e as p,f as o,n as A,t as k,g as le,h as u,_ as Q,i as H,j as se,k as z,l as V,F as N,m as Y,w as j,p as w,N as ie,S as re,q as ue}from"./index-C6prHhVu.js";import{u as de}from"./basketStore-DN1xKs_o.js";import{T as G}from"./Top10Movie-9vCN4oYE.js";const ce={key:0,class:"random-movie"},me={class:"random-movie__wrapper"},ve={class:"random-movie__info-block"},fe={class:"random-movie__details"},ye={class:"random-movie__rating-text"},pe={class:"random-movie__release-year"},_e={class:"random-movie__genre"},ge={class:"random-movie__duration"},he={class:"random-movie__title"},be={class:"random-movie__description"},Le={class:"random-movie__actions"},Ce={key:0,class:"random-movie__like-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Te={key:1,class:"random-movie__like-icon-filled",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Me=["alt","src"],ke=["src","alt"],Ee={key:1,class:"loader"},Se=J({__name:"RandomMovie",setup(e){const b=le(),d=oe(),i=$(),r=de(),t=x(null),m=x(!0),v=x(!1),_=ne();$(),K(async()=>{try{const n=await i.getRandomMovie();t.value=n}catch(n){console.error("Ошибка загрузки:",n)}finally{m.value=!1}});const s=n=>{let l=Math.trunc(n/60),R=n%60;return`${l} ч. ${R} мин`},f=O(()=>{if(!t.value?.tmdbRating)return"";const n=t.value.tmdbRating;if(n>=8.6)return"random-movie__rating--gold";if(n>=7.5)return"random-movie__rating--green";if(n>=6.3)return"random-movie__rating--grey";if(n>=4.2)return"random-movie__rating--red"}),L=O(()=>t.value?.id?r.isInBasket(t.value.id):!1),T=()=>{t.value&&(d.isAuthenticated?L.value?r.removeFromBasket(t.value.id):r.addToBasket(t.value):_.openModalWindow())},h=async()=>{m.value=!0;try{const n=await i.getRandomMovie();t.value=n}catch(n){console.error("Ошибка загрузки",n)}},I=()=>{v.value=!v.value},E=O(()=>{if(!t.value?.trailerUrl)return"";const n=t.value.trailerUrl;let l="";return n.includes("youtube.com/watch?v=")?l=n.split("v=")[1]?.split("&")[0]:n.includes("youtu.be/")?l=n.split("youtu.be/")[1]?.split("?")[0]:t.value.trailerYouTubeId&&(l=t.value.trailerYouTubeId),l?`https://www.youtube.com/embed/${l}?autoplay=1`:""}),y=()=>{v.value=!1},S=()=>{t.value.id&&b.push(`/film/${t.value.id}`)};return(n,l)=>t.value?(u(),p("article",ce,[o("div",me,[o("div",ve,[o("div",fe,[o("span",{class:A(["random-movie__rating",f.value])},[l[0]||(l[0]=o("svg",{class:"rating-movie__star",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M8.00105 12.1734L3.29875 14.8055L4.34897 9.51997L0.392578 5.86124L5.74394 5.22675L8.00105 0.333374L10.2581 5.22675L15.6095 5.86124L11.6531 9.51997L12.7033 14.8055L8.00105 12.1734Z",fill:"white"})],-1)),o("span",ye,k(t.value.tmdbRating),1)],2),o("span",pe,k(t.value.releaseYear),1),o("span",_e,k(t.value.genres?.[0]),1),o("span",ge,k(s(t.value.runtime)),1)]),o("h2",he,k(t.value.title),1),o("p",be,k(t.value.plot),1),o("div",Le,[o("button",{class:"random-movie__trailer-btn btn",type:"button",onClick:I}," Трейлер"),o("button",{class:"random-movie__about-btn btn",type:"button",onClick:S}," О фильме"),o("button",{class:A(["random-movie__favorite-btn btn btn--circle",{"random-movie__favorite-btn--clicked":L.value}]),type:"button",onClick:T},[L.value?(u(),p("svg",Te,[...l[2]||(l[2]=[o("path",{d:"M16.5 3C19.5376 3 22 5.5 22 9C22 16 14.5 20 12 21.5C9.5 20 2 16 2 9C2 5.5 4.5 3 7.5 3C9.35997 3 11 4 12 5C13 4 14.64 3 16.5 3Z",fill:"#B4A9FF"},null,-1)])])):(u(),p("svg",Ce,[...l[1]||(l[1]=[o("path",{d:"M16.5 3C19.5376 3 22 5.5 22 9C22 16 14.5 20 12 21.5C9.5 20 2 16 2 9C2 5.5 4.5 3 7.5 3C9.35997 3 11 4 12 5C13 4 14.64 3 16.5 3ZM12.9339 18.6038C13.8155 18.0485 14.61 17.4955 15.3549 16.9029C18.3337 14.533 20 11.9435 20 9C20 6.64076 18.463 5 16.5 5C15.4241 5 14.2593 5.56911 13.4142 6.41421L12 7.82843L10.5858 6.41421C9.74068 5.56911 8.5759 5 7.5 5C5.55906 5 4 6.6565 4 9C4 11.9435 5.66627 14.533 8.64514 16.9029C9.39 17.4955 10.1845 18.0485 11.0661 18.6038C11.3646 18.7919 11.6611 18.9729 12 19.1752C12.3389 18.9729 12.6354 18.7919 12.9339 18.6038Z",fill:"currentColor"},null,-1)])]))],2),o("button",{class:"random-movie__random-btn btn btn--circle",type:"button",onClick:h},[...l[3]||(l[3]=[o("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M12 4C14.7486 4 17.1749 5.38626 18.6156 7.5H16V9.5H22V3.5H20V5.99936C18.1762 3.57166 15.2724 2 12 2C6.47715 2 2 6.47715 2 12H4C4 7.58172 7.58172 4 12 4ZM20 12C20 16.4183 16.4183 20 12 20C9.25144 20 6.82508 18.6137 5.38443 16.5H8V14.5H2V20.5H4V18.0006C5.82381 20.4283 8.72764 22 12 22C17.5228 22 22 17.5228 22 12H20Z",fill:"white"})],-1)])])])]),o("img",{class:"random-movie__img",alt:t.value.title,src:t.value.posterUrl,width:"680",height:"300",frameborder:"0"},null,8,Me)]),o("div",{class:A(["random-movie__watch-trailer-window",{"random-movie__watch-trailer-window--show":v.value}])},[o("button",{class:"random-movie__close-trailer-btn btn btn--close",type:"button",onClick:y},[...l[4]||(l[4]=[o("svg",{class:"random-movie__close-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M10.5859 12L2.79297 4.20706L4.20718 2.79285L12.0001 10.5857L19.793 2.79285L21.2072 4.20706L13.4143 12L21.2072 19.7928L19.793 21.2071L12.0001 13.4142L4.20718 21.2071L2.79297 19.7928L10.5859 12Z",fill:"black"})],-1)])]),o("iframe",{src:E.value,alt:t.value.title,class:"random-movie__iframe",controls:"",width:"960",height:"540",allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:"",title:"Трейлер фильма"},null,8,ke)],2)])):(u(),p("span",Ee))}}),Be=Q(Se,[["__scopeId","data-v-f1991624"]]);function De({swiper:e,extendParams:b,on:d,emit:i,params:r}){e.autoplay={running:!1,paused:!1,timeLeft:0},b({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let t,m,v=r&&r.autoplay?r.autoplay.delay:3e3,_=r&&r.autoplay?r.autoplay.delay:3e3,s,f=new Date().getTime(),L,T,h,I,E,y,S;function n(a){!e||e.destroyed||!e.wrapperEl||a.target===e.wrapperEl&&(e.wrapperEl.removeEventListener("transitionend",n),!(S||a.detail&&a.detail.bySwiperTouchMove)&&C())}const l=()=>{if(e.destroyed||!e.autoplay.running)return;e.autoplay.paused?L=!0:L&&(_=s,L=!1);const a=e.autoplay.paused?s:f+_-new Date().getTime();e.autoplay.timeLeft=a,i("autoplayTimeLeft",a,a/v),m=requestAnimationFrame(()=>{l()})},R=()=>{let a;return e.virtual&&e.params.virtual.enabled?a=e.slides.find(c=>c.classList.contains("swiper-slide-active")):a=e.slides[e.activeIndex],a?parseInt(a.getAttribute("data-swiper-autoplay"),10):void 0},F=a=>{if(e.destroyed||!e.autoplay.running)return;cancelAnimationFrame(m),l();let g=typeof a>"u"?e.params.autoplay.delay:a;v=e.params.autoplay.delay,_=e.params.autoplay.delay;const c=R();!Number.isNaN(c)&&c>0&&typeof a>"u"&&(g=c,v=c,_=c),s=g;const D=e.params.speed,q=()=>{!e||e.destroyed||(e.params.autoplay.reverseDirection?!e.isBeginning||e.params.loop||e.params.rewind?(e.slidePrev(D,!0,!0),i("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(e.slides.length-1,D,!0,!0),i("autoplay")):!e.isEnd||e.params.loop||e.params.rewind?(e.slideNext(D,!0,!0),i("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(0,D,!0,!0),i("autoplay")),e.params.cssMode&&(f=new Date().getTime(),requestAnimationFrame(()=>{F()})))};return g>0?(clearTimeout(t),t=setTimeout(()=>{q()},g)):requestAnimationFrame(()=>{q()}),g},Z=()=>{f=new Date().getTime(),e.autoplay.running=!0,F(),i("autoplayStart")},B=()=>{e.autoplay.running=!1,clearTimeout(t),cancelAnimationFrame(m),i("autoplayStop")},M=(a,g)=>{if(e.destroyed||!e.autoplay.running)return;clearTimeout(t),a||(y=!0);const c=()=>{i("autoplayPause"),e.params.autoplay.waitForTransition?e.wrapperEl.addEventListener("transitionend",n):C()};if(e.autoplay.paused=!0,g){E&&(s=e.params.autoplay.delay),E=!1,c();return}s=(s||e.params.autoplay.delay)-(new Date().getTime()-f),!(e.isEnd&&s<0&&!e.params.loop)&&(s<0&&(s=0),c())},C=()=>{e.isEnd&&s<0&&!e.params.loop||e.destroyed||!e.autoplay.running||(f=new Date().getTime(),y?(y=!1,F(s)):F(),e.autoplay.paused=!1,i("autoplayResume"))},P=()=>{if(e.destroyed||!e.autoplay.running)return;const a=H();a.visibilityState==="hidden"&&(y=!0,M(!0)),a.visibilityState==="visible"&&C()},W=a=>{a.pointerType==="mouse"&&(y=!0,S=!0,!(e.animating||e.autoplay.paused)&&M(!0))},U=a=>{a.pointerType==="mouse"&&(S=!1,e.autoplay.paused&&C())},X=()=>{e.params.autoplay.pauseOnMouseEnter&&(e.el.addEventListener("pointerenter",W),e.el.addEventListener("pointerleave",U))},ee=()=>{e.el&&typeof e.el!="string"&&(e.el.removeEventListener("pointerenter",W),e.el.removeEventListener("pointerleave",U))},te=()=>{H().addEventListener("visibilitychange",P)},ae=()=>{H().removeEventListener("visibilitychange",P)};d("init",()=>{e.params.autoplay.enabled&&(X(),te(),Z())}),d("destroy",()=>{ee(),ae(),e.autoplay.running&&B()}),d("_freeModeStaticRelease",()=>{(h||y)&&C()}),d("_freeModeNoMomentumRelease",()=>{e.params.autoplay.disableOnInteraction?B():M(!0,!0)}),d("beforeTransitionStart",(a,g,c)=>{e.destroyed||!e.autoplay.running||(c||!e.params.autoplay.disableOnInteraction?M(!0,!0):B())}),d("sliderFirstMove",()=>{if(!(e.destroyed||!e.autoplay.running)){if(e.params.autoplay.disableOnInteraction){B();return}T=!0,h=!1,y=!1,I=setTimeout(()=>{y=!0,h=!0,M(!0)},200)}}),d("touchEnd",()=>{if(!(e.destroyed||!e.autoplay.running||!T)){if(clearTimeout(I),clearTimeout(t),e.params.autoplay.disableOnInteraction){h=!1,T=!1;return}h&&e.params.cssMode&&C(),h=!1,T=!1}}),d("slideChange",()=>{e.destroyed||!e.autoplay.running||(E=!0)}),Object.assign(e.autoplay,{start:Z,stop:B,pause:M,resume:C})}const xe={key:0,class:"top-catalog"},Ie={key:0,class:"top-catalog__catalog"},Fe={key:1,class:"loader"},we=J({__name:"HomeView",setup(e){const b=$(),d=x(null),i=x(!0),r=O(()=>b.top10Movies),t=v=>{d.value=v},m=()=>{i.value=window.innerWidth>580};return K(async()=>{m(),window.addEventListener("resize",m),await b.loadAllMovies(),await b.loadTop10()}),se(()=>{m(),window.removeEventListener("resize",m)}),(v,_)=>(u(),p(N,null,[z(Be),r.value.length!==0?(u(),p("article",xe,[_[0]||(_[0]=o("h2",{class:"top-catalog__title"},"Топ 10 фильмов",-1)),i.value?(u(),p("div",Ie,[(u(!0),p(N,null,Y(r.value,(s,f)=>(u(),V(G,{key:s.id,film:s,number:f},null,8,["film","number"]))),128))])):(u(),V(w(re),{key:1,modules:[w(De),w(ie)],"slides-per-view":1,"space-between":40,onSwiper:t,navigation:!0,loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1,pauseOnMouseEnter:!0}},{default:j(()=>[(u(!0),p(N,null,Y(r.value,(s,f)=>(u(),V(w(ue),{class:"swiper-slide",key:s.id},{default:j(()=>[z(G,{class:"swiper-movie",film:s,movies:r.value,number:f},null,8,["film","movies","number"])]),_:2},1024))),128))]),_:1},8,["modules"]))])):(u(),p("span",Fe))],64))}}),He=Q(we,[["__scopeId","data-v-8195871f"]]);export{He as default};
